@prefix drafting: <http://example.org/ontology/drafting/> .
@prefix case-investigation: <https://ontology.caseontology.org/case/investigation/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix uco-action: <https://unifiedcyberontology.org/ontology/uco/action#> .
@prefix uco-core: <https://unifiedcyberontology.org/ontology/uco/core#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

drafting:AbstractHypothesis
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf uco-core:UcoObject ;
	rdfs:label "AbstractHypothesis"@en ;
	rdfs:comment "A hypothesis making either an affirmative assertion or a negative assertion.  Defined as an abstract superclass of Hypothesis and NegativeHypothesis."@en ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	sh:targetClass drafting:AbstractHypothesis ;
	.

drafting:AnalyticAssertion
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf case-investigation:InvestigativeAction ;
	sh:property [
		rdfs:comment "An evaluation must use one or more Inferences."@en ;
		sh:path uco-core:hasFacet ;
		sh:qualifiedMinCount "1"^^xsd:integer ;
		sh:qualifiedValueShape [
			a sh:NodeShape ;
			sh:property [
				sh:path uco-action:object ;
				sh:qualifiedMinCount "1"^^xsd:integer ;
				sh:qualifiedValueShape [
					sh:class drafting:AnalyticInference ;
				] ;
			] ;
		] ;
	] ;
	sh:targetClass drafting:AnalyticAssertion ;
	.

drafting:AnalyticEvaluation
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf case-investigation:InvestigativeAction ;
	sh:property [
		rdfs:comment "An evaluation must produce one or more Inferences."@en ;
		sh:path uco-core:hasFacet ;
		sh:qualifiedMinCount "1"^^xsd:integer ;
		sh:qualifiedValueShape [
			a sh:NodeShape ;
			sh:property [
				sh:path uco-action:result ;
				sh:qualifiedMinCount "1"^^xsd:integer ;
				sh:qualifiedValueShape [
					sh:class drafting:AnalyticInference ;
				] ;
			] ;
		] ;
	] ;
	sh:targetClass drafting:AnalyticAssertion ;
	.

drafting:AnalyticInference
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf uco-core:UcoObject ;
	sh:property
		[
			sh:minCount "1"^^xsd:integer ;
			sh:path uco-core:description ;
		] ,
		[
			sh:class drafting:AbstractHypothesis ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:path drafting:hasHypothesis ;
		] ,
		[
			sh:class drafting:Method ;
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:path drafting:usedMethod ;
		] ,
		[
			sh:class uco-core:UcoObject ;
			owl:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:path drafting:basisEvidence ;
		] ,
		[
			sh:datatype xsd:decimal ;
			sh:maxCount "1"^^xsd:integer ;
			sh:nodeKind sh:Literal ;
			sh:path drafting:evidenceEvaluation ;
		] ,
		[
			sh:datatype xsd:string ;
			sh:maxCount "1"^^xsd:integer ;
			sh:nodeKind sh:Literal ;
			sh:path drafting:evaluationRationale ;
		] ,
		[
			sh:datatype xsd:string ;
			sh:maxCount "1"^^xsd:integer ;
			sh:nodeKind sh:Literal ;
			sh:path drafting:evaluationType ;
		]
		;
	rdfs:label "Inference"@en ;
	rdfs:comment "An opinion that is formed on the basis of observed objects (evidence) in light of a given hypothesis." ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	sh:targetClass drafting:AnalyticInference ;
	.

drafting:Hypothesis
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf
		drafting:AbstractHypothesis ,
		owl:Axiom
		;
	rdfs:label "Hypothesis"@en ;
	sh:property
		[
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:path owl:annotatedSource ;
		] ,
		[
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:or (
				[
					sh:class owl:DatatypeProperty ;
				]
				[
					sh:class owl:ObjectProperty ;
				]
				[
					sh:hasValue rdf:type ;
				]
			) ;
			sh:path owl:annotatedProperty ;
		] ,
		[
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:path owl:annotatedTarget ;
		]
		;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	sh:targetClass drafting:Hypothesis ;
	.

drafting:Method
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf uco-action:ActionLifecycle ;
	rdfs:label "Method"@en ;
	rdfs:comment
		"A method is a form of procedura for accomplishing a specific task."@en
		;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	sh:targetClass drafting:Method ;
	.

drafting:NegativeHypothesis
	a
		owl:Class ,
		sh:NodeShape
		;
	rdfs:subClassOf
		drafting:AbstractHypothesis ,
		owl:NegativePropertyAssertion
		;
	rdfs:label "NegativeHypothesis"@en ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	sh:property
		[
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:path owl:sourceIndividual ;
		] ,
		[
			sh:maxCount "1"^^xsd:integer ;
			sh:minCount "1"^^xsd:integer ;
			sh:nodeKind sh:BlankNodeOrIRI ;
			sh:or (
				[
					sh:class owl:DatatypeProperty ;
				]
				[
					sh:class owl:ObjectProperty ;
				]
				[
					sh:hasValue rdf:type ;
				]
			) ;
			sh:path owl:assertionProperty ;
		] ,
		[
			rdfs:comment: "Absence of targetIndividual will result in negation of all triples with matching sourceIndividual and assertionProperty."@en ;
			sh:maxCount "1"^^xsd:integer ;
			sh:path owl:targetIndividual ;
		]
		;
	sh:targetClass drafting:NegativeHypothesis ;
	.

drafting:basisEvidence
	a owl:ObjectProperty ;
	rdfs:label "basisEvidence"@en ;
	rdfs:comment "Observed object(s) being evaluated as support for an inference." ;
	rdfs:range uco-core:UcoObject ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

drafting:evaluationRationale
	a owl:DatatypeProperty ;
	rdfs:label "evaluationRationale"@en ;
	rdfs:comment "Explanation of the rationale for an assigned number"@en ;
	rdfs:range xsd:string ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

drafting:evaluationType
	a owl:DatatypeProperty ;
	rdfs:label "evaluationType"@en ;
	rdfs:comment "What an assigned number represents such as probability, strength, similarity, etc."@en ;
	rdfs:range xsd:string ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

drafting:evidenceEvaluation
	a owl:DatatypeProperty ;
	rdfs:label "evidenceEvaluation"@en ;
	rdfs:comment
		"(TODO This should probably go into UCO Core.)"@en ,
		"A number that represents the probability, strength, similarity, etc. of the observed object(s) in light of the hypothesis."@en
		;
	rdfs:range xsd:float ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

drafting:hasHypothesis
	a owl:ObjectProperty ;
	rdfs:label "hasHypothesis"@en ;
	rdfs:comment "A proposed explanation, represented as an OWL Axiom, made on the basis of initial observations as a starting point for further investigation."@en ;
	rdfs:range drafting:Hypothesis ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

drafting:usedMethod
	a owl:ObjectProperty ;
	rdfs:label "usedMethod"@en ;
	rdfs:comment "The process/algorithm used to assign a value to the observed evidence such as probability model, computed similarity (e.g., Levenshtein distance), strength of evidence (e.g. C-Scale)." ;
	rdfs:range drafting:Method ;
	rdfs:seeAlso <https://case.atlassian.net/browse/ONT-434> ;
	.

